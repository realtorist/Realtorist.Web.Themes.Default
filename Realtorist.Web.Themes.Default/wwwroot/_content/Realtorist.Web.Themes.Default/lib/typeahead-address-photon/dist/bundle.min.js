!function(){"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=e(Bloodhound);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);return e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!=typeof e&&"function"!=typeof e?f(t):e}}function l(e,t,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(e){t=Object.getOwnPropertyDescriptor(e,t);return t.get?t.get.call(r):t.value}})(e,t,r||e)}function u(e){return e.properties.osm_value}var p=function(){function t(e){i(this,t),c(this,"url","https://photon.komoot.io"),c(this,"limit",5),c(this,"formatType",null),c(this,"formatResult",null),c(this,"lat",null),c(this,"lon",null),c(this,"lang",null),e&&Object.assign(this,e)}return r(t,[{key:"api",get:function(){return this.url+"/api/"}},{key:"reverse",get:function(){return this.url+"/reverse"}},{key:"formatResultFunc",get:function(){return this.formatResult||(n=this.formatType||u,function(e){var t=n(e),r=e.properties.name;return t&&(r+=", "+t),e.properties.city&&e.properties.city!==e.properties.name&&(r+=", "+e.properties.city),e.properties.country&&(r+=", "+e.properties.country),r});var n}},{key:"reqParams",get:function(){var e={limit:this.limit};return this.lat&&this.lon&&(e.lat=this.lat,e.lon=this.lon),this.lang&&(e.lang=this.lang),e}}]),t}(),h=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(u,o["default"]);var n=t(u);function u(r){var e,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.$;return i(this,u),r=new p(r),c(f(e=n.call(this,{local:[],queryTokenizer:o.default.tokenizers.nonword,datumTokenizer:u.datumTokenizer,identify:u.identify,remote:{url:r.api,sufficient:r.limit,prepare:function(e,t){return t.data=r.reqParams,t.data.q=e,t},transform:function(e){return e.features.forEach(function(e){e.description=r.formatResultFunc(e)}),e.features||[]}}})),"options",void 0),c(f(e),"jQuery",void 0),e.options=r,e.jQuery=t,e}return r(u,[{key:"search",value:function(e,n,o){var i=this,t=this.jQuery.Deferred(),r=this.jQuery.Deferred();l(s(u.prototype),"search",this).call(this,e,function(e){t.resolve(e)},function(e){r.resolve(e)}),this.jQuery.when(t,r).then(function(e,t){var r=[].concat(e,t);i.jQuery(i).trigger("addresspicker:predictions",[r]),n(e),o(t)})}},{key:"bindDefaultTypeaheadEvent",value:function(e){var r=this;e.bind("typeahead:selected",function(e,t){r.jQuery(r).trigger("addresspicker:selected",[t])})}},{key:"reverseGeocode",value:function(e){var t=this;this.jQuery.get(this.options.reverse,{lat:e[0],lon:e[1]}).then(function(e){e.features&&((e=e.features[0]).description=t.options.formatResultFunc(e),t.jQuery(t).trigger("addresspicker:selected",[e]))})}}],[{key:"datumTokenizer",value:function(e){return o.default.tokenizers.obj.whitespace(["country","city","postcode","name","state"])(e.properties)}},{key:"identify",value:function(e){return e.properties.osm_id}}]),u}();window.PhotonAddressEngine=h}();
